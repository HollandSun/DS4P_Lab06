---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Insert your name here"
date: "Insert date here"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
```

### Exercise 1

Oh,In my contrast,I chose Lab06 for this week(I mean the fifth lab work for me,I just realized that I didn't change the lab number in contrast,So i quickly change it),
Although in this Lab I still have to learn some tips from previous Module, I just want to qucik up my steps.

```{r}
staff <- read_csv("data/instructional-staff.csv")
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))
staff_long %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = faculty_type
  )) +
  geom_line()
```


```{r better-plot1, fig.width=12, fig.height=6, warning=FALSE, message=FALSE}

staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))

staff_long %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = ifelse(faculty_type == "Part-Time Faculty", "Part-Time Faculty", "Other"),
    linewidth = ifelse(faculty_type == "Part-Time Faculty", "highlight", "background"),
    alpha = ifelse(faculty_type == "Part-Time Faculty", "highlight", "background")
  )) +
  geom_line() +
  scale_color_manual(values = c("Part-Time Faculty" = "#000000", "Other" = "gray20")) +
  scale_linewidth_manual(values = c("highlight" = 1.2, "background" = 0.8)) +
  scale_alpha_manual(values = c("highlight" = 1, "background" = 0.8)) +
  geom_text(
    data = ~ .x %>% filter(year == "2011"),
    aes(label = faculty_type),
    hjust = 0,
    nudge_x = 0.1,
    size = 3,
    show.legend = FALSE
  ) +
  scale_x_discrete(expand = expansion(mult = c(0.05, 0.3))) +
  scale_y_continuous(labels = scales::percent_format(scale = 1))+
  labs(
    title = "Instructional Staff Employment Trends, 1975–2011",
    subtitle = "Part-time faculty has grown significantly over time",
    x = "Year",
    y = "Percentage of Total Instructional Staff"
  ) +
theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank()
  )
```
The original line plot includes information for all instructional staff types, but it does not do a very good job of telling the main story that the part-time faculty has increased over time. First, all of the lines look visually similar (even though they are different colors), which makes the part-time faculty line hard to stand out. Second, as I said the different colors (or the legend) is confusing, it requires the reader to move back and forth between the legend and the color. This makes the figure feel less "simple". There are also some smaller issues, such as no title, the background gridlines looking cluttered, and the axis ticks not being very clear.

In the revised visualization, I highlighted the “Part-Time Faculty” group by using a thicker line with stronger contrast to emphasize its upward trend over time, and also fading the other types into light-gray lines. Second I removed the legend and labeled each line at its endpoint (I think it much straight forward). Finally, I adjusted the spacing between the axis titles and tick marks, removed unnecessary minor gridlines, centered the title, and added clearer axis labels with percentage units to improve overall readability.
### Exercise 2

Remove this text, and add your answer for Exercise 1 here.
Add code chunks as needed.
Don't forget to label your code chunk.
Do not use spaces in code chunk labels.

### Exercise 3

...

Add exercise headings as needed.
